function delcfm(){$("#delcfmModel").modal()}function urlSubmit(){var a=$.trim($("#url").val());window.location.href=a}$(function(){searchPaper();$("#querBtn").click(function(){$("#currentPage").val("");searchPaper()})});function searchPaper(){$.ajax({url:"findPaper_findPapers.action",data:{currentPage:$("#currentPage").val(),currentCount:$("#currentCount").val(),title:$("#title").val(),level:$("#level option:selected").val(),paperStatus:$("#paperStatus option:selected").val(),},type:"POST",async:true,dataType:"text",success:showTable,error:function(){alert("请求失败！")}})}function showTable(data){var result=eval("("+data+")");$("#paperTableBody").html("");var currentPage=result.pageBean.currentPage;var totalCount=result.pageBean.totalCount;var currentCount=result.pageBean.currentCount;var papers=result.pageBean.productList;for(var i=0,length=papers.length;i<length;i++){var index=(currentPage-1)*currentCount+i+1;var str="<tr><td>"+index+"</td><td>"+papers[i].title+"</td><td>"+replaceLevel(papers[i].level)+"</td><td>"+papers[i].paperscore+"</td><td>"+papers[i].usetimes+"</td><td>"+papers[i].description+"</td><td>"+papers[i].employeename+"</td><td>"+papers[i].maketime+"</td><td><a title='预览试卷' href='"+contextPath+"/findPaper_findPaperAllInfoById.action?paperId="+papers[i].paperid+"'><span class='glyphicon glyphicon-search'></span></a>";if(papers[i].usetimes=="0"){str+="<a title='修改试卷' href='javascript:void(0)' onclick='updatePaper(\""+papers[i].paperid+"\")'><span class='glyphicon glyphicon-pencil'></span></a><a title='删除试卷' href='javascript:void(0)' onclick='deletePaper(\""+papers[i].paperid+"\")'><span class='glyphicon glyphicon-trash'></span></a>"}if(papers[i].paperanswer=="0"){str+="<a title='归档试卷' href='javascript:void(0)' onclick='archivePaper(\""+papers[i].paperid+"\")'><span class='glyphicon glyphicon-log-in'></span></a>"}else{str+="<a title='撤销试卷归档' href='javascript:void(0)' onclick='noArchivePaper(\""+papers[i].paperid+"\")'><span class='glyphicon glyphicon-log-out'></span></a>"}str+="</td></tr>";$("#paperTableBody").append(str)}page(currentPage,totalCount,currentCount)}function page(c,a,b){$("#paginationID").pagination({total:a,pageSize:b,pageNumber:c,pageList:[8,15,20],layout:["list","sep","first","prev","manual","next","last","links"],onSelectPage:function(e,d){$("#currentPage").val(e);$("#currentCount").val(d);searchPaper()}})}function deletePaper(a){if(confirm("确认删除试卷?删除后将不可恢复！")){$.ajax({url:contextPath+"/deletePaper.action",data:{paperId:a},type:"POST",dataType:"json",async:true,success:function(b){alert(b);if(b=="已经有考试使用本试卷，你不能删除试卷！"){return}window.location.reload()},error:function(){alert("请求失败")}})}}function updatePaper(b){$.post(contextPath+"/update_findPaperStatus.action",{paperId:b},a,"json");function a(c){if(c==0){alert("该试卷已经被考试用过且考试已经开始,不允许修改，建议您去新创建试卷!");return}self.location=contextPath+"/update_findPaperAllInfoById.action?paperId="+b}}function replaceLevel(a){if(a=="1"){return"厂级"}if(a=="2"){return"部门级"}if(a=="3"){return"班组级"}}function archivePaper(a){if(confirm("您确认归档?")){$.post(contextPath+"/update_updatePaperanswer.action",{paperId:a,paperStatus:"1"},function(b){alert(b);searchPaper()},"json")}}function noArchivePaper(a){if(confirm("您确认取消归档?")){$.post(contextPath+"/update_updatePaperanswer.action",{paperId:a,paperStatus:"0"},function(b){alert(b);searchPaper()},"json")}};