$(function(){initEmployeeTypeDic();var b=$("#el_bigStatusMark").val();$("#bigStatus_Mark").val(b);var a=$("#el_breakType").val();$("#breakInfo_Type").val(a);searchDepartmentAndOverHualTree(b);findEmployeeOutBaseInfo();jQuery.validator.addMethod("isNumber",function(f,d){var e=f.length;var c=/(^\d+$)/;return this.optional(d)||(c.test(f))},"请输入数字");initEmployeePhyAndEducate()});function initEmployeeTypeDic(){$.post(basePathUrl+"/dic_getDicNamesByUpid.action",{upId:"100"},showEmployeeTypeDic,"json")}function showEmployeeTypeDic(a){if(a!=null&&a.names!=null){var c=a.names;$("#query_empType").append("<option value=''>--请选择--</option>");for(var b=0;b<c.length;b++){$("#query_empType").append('<option value="'+c[b]+'">'+c[b]+"</option>")}}}function queryEmployeeOutBaseInfo(){$("#currentPage").val("");findEmployeeOutBaseInfo()}function findEmployeeOutBaseInfo(){$.ajax({url:"employeeOutPerson_getEmployeeOutBaseInfoList.action",data:$("#form_findEmployeeOutBaseInfo").serialize(),type:"post",dataType:"json",success:showEmployeeBaseInfo,error:function(){alert("请求失败！")}})}function showEmployeeBaseInfo(h){var c=h.pageBean.productList;var f="";for(var e=0;e<c.length;e++){var b=e+1;f+="<tr><td><input type='radio' name='el_chooseEmp' class='el_checks' vaule='"+c[e].idCard+"'/></td><td>"+(b+(h.pageBean.currentPage-1)*$("#currentCount").val())+"<input class='find_employeeOutBirthday' type='hidden' value='"+c[e].birthday+"'/><input class='find_employeeOutPhy' type='hidden' value='"+c[e].empphysicalstatus+"'/><input class='find_employeeOutEducate' type='hidden' value='"+c[e].empeducate+"'/><input class='find_thirdScore' type='hidden' value='"+c[e].thirdScore+"'/><input class='find_safeHatNum' type='hidden' value='"+c[e].safeHatNum+"'/><input class='find_employeeOutPhoto' type='hidden' value='"+c[e].photo+"'/><input class='find_employeeOutId' type='hidden' value='"+c[e].employeeId+"'/><input class='find_bigEmployeeOutId' type='hidden' value='"+c[e].BigEmployeeoutId+"'/><input class='find_bigId' type='hidden' value='"+c[e].bigId+"'/><input class='find_unitId' type='hidden' value='"+c[e].unitId+"'/><input class='find_minusnumsum' type='hidden' value='"+c[e].minusNumSum+"'/><input class='find_idCard' type='hidden' value='"+c[e].idCard+"'/><input class='find_address' type='hidden' value='"+c[e].address+"'/></td><td>"+c[e].name+"</td><td>"+(c[e].sex>1?"女":"男")+"</td><td>"+c[e].birthday.substring(0,10)+"</td><td>"+c[e].departmentName+"</td><td>"+c[e].empType+"</td><td onclick='el_breakRulesCase(this)' class='success'>"+c[e].sumBreakScore+"</td>";if(c[e].isblackList=="是"){f+="<td style='color:red;'>"+c[e].isblackList+"</td><td>"}else{if(c[e].isInBlackList=="是"){f+="<td style='color:#F9BA0F;'>"+c[e].isblackList+"</td><td>"}else{f+="<td>"+c[e].isblackList+"</td><td>"}}f+="<a href=javascript:void(0) onclick='queryHatChangeLog(this)'>"+replaceNull(c[e].safeHatNum)+"</a></td><td>";f+="<a href='javascript:void(0)' onclick='allInfo(this)' title='查看详情'><span class='glyphicon glyphicon-search'></span></a>&nbsp;";if(c[e].bigStatus!="已结束"&&hasOperatingEmpout){f+="<a href='javascript:void(0)' onclick='el_modifyEmp(this)' title='修改信息'><span class='glyphicon glyphicon-pencil'></span></a>&nbsp;<a class='el_delButton' onClick='delcfm(this)' title='删除信息'><span class='glyphicon glyphicon-trash'></span></a><br /></td></tr>"}else{f+="</td></tr>"}}$("#employeeOutBaseInfoList").empty();$("#employeeOutBaseInfoList").append(f);var g=h.pageBean.currentPage;var a=h.pageBean.totalCount;var d=h.pageBean.currentCount;outdepartEmpManage_page(g,a,d)}function outdepartEmpManage_page(c,a,b){$("#paginationIDU").pagination({total:a,pageSize:b,pageNumber:c,pageList:[8,15,20],layout:["list","sep","first","prev","manual","next","last","links"],onSelectPage:function(e,d){$("#currentPage").val(e);$("#currentCount").val(d);findEmployeeOutBaseInfo()}})}function trainStatus_page(c,a,b){$("#paginationID2").pagination({total:a,pageSize:8,pageNumber:c,pageList:[8],layout:["list","sep","first","prev","manual","next","last","links"],onSelectPage:function(e,d){showEmployeeOutExamsInfoList(b,e,d)}})}function clearQueryInfo(){$(".curSelectedNode").removeClass("curSelectedNode");$("#query_bigId").val("");$("#query_unitId").val("");$("#inpstart2").val("");$("#inpend2").val("")}function initEmployeeTypeDic_add(){$.post(basePathUrl+"/dic_getDicNamesByUpid.action",{upId:"100"},showEmployeeTypeDic_add,"json")}function showEmployeeTypeDic_add(a){$("#add_employeeOutType").empty();if(a!=null&&a.names!=null){var c=a.names;$("#add_employeeOutType").append("<option value='0'>--请选择--</option>");for(var b=0;b<c.length;b++){if(c[b]=="普工"){$("#add_employeeOutType").append('<option selected value="'+c[b]+'">'+c[b]+"</option>")}else{$("#add_employeeOutType").append('<option value="'+c[b]+'">'+c[b]+"</option>")}}}}function el_addEmp(){if(clickRes==0){alert("请选择要添加员工的部门！")}else{$.post(basePathUrl+"/haul_getHaulinfoByHaulid.action",{haulId:selectedOverHaulId},showAddunitModal,"json")}}function showAddunitModal(a){if(a!=null&&a.haulinfo!=null){var b=a.haulinfo;if(b.bigstatus=="已结束"){alert("该大修已经结束，您不可以操作该大修下的部门！");return}$("#addEmployeeOutInfoList").empty();initAddModel();$("#form_addEmployeeOutInfo").empty();idCardArrays.splice(1,idCardArrays.length-1);initEmployeeTypeDic_add();$("#el_addEmp").modal()}}var employeeOutSeq=0;var idCardArrays=["123"];function addEmployeeOutInfo(){var g=false;var e=$("#add_employeeOutType option:selected").val();var p=$("#certNumber").val();var q=new Date();var j=$("#birthday").val();var c=new Date(j);var f=q.getTime()-c.getTime();var k=Math.ceil(f/1000/60/60/24/365);var m=true;if(k<18){alert("该员工年龄小于18岁！");m=false}if(k>55){alert("该员工年龄大于55岁！");m=false}for(var n=0;n<idCardArrays.length;n++){if(idCardArrays[n]==p){g=true}}if(e==0){alert("请为该员工选择一个工种！")}else{if(g){alert("该员工已经添加到表格中！")}else{if(p.length<=0){alert("请点击读取身份证信息将员工身份证信息读出！")}else{var s=$("#personName").val();var h=$("#gender").val();var j=$("#birthday").val();var d=$("#address").val();var d=$("#address").val();var a=$("#add_employeePhy option:selected").text();var b=$("#add_employeeEducate option:selected").text();var o=$("#add_bigId").val();var l=$("#add_employeeOutType option:selected").text();var r=$("#idCardImageStr").val();$.ajax({url:"employeeOutPerson_checkAddEmployeeOutStatuss.action",data:{employeeOutIdCard:p,bigId:o,unitId:departmentId},dataType:"json",type:"post",success:function(i){if(i.status==3){alert("该员工已进入黑名单，不能添加！")}else{if(i.status==5){alert("该员工违章已经累计超过12分，积分周期内不能添加！")}else{idCardArrays.push(p);var u="<tr><td>"+l+"</td><td>"+s+"</td><td>"+h+"</td><td>"+p+"</td><td>"+a+"</td><td>"+b+"</td><td><a class='el_delButton' onClick='deleteAddInfo(this)'>删除</a><br/></td></tr>";$("#addEmployeeOutInfoList").append(u);if(i.status==1){$.ajax({url:"employeeOutPerson_saveEmployeePhoto.action",data:{employeeOutIdCard:p,photoStr:r},type:"post"});h=h.toString().replace("男","1").replace("女","2");var t="<input name='employeeOutList["+employeeOutSeq+"].name' type='hidden' value='"+s+"'/><input name='employeeOutList["+employeeOutSeq+"].idcode' type='hidden' value='"+p+"'/><input name='employeeOutList["+employeeOutSeq+"].sex' type='hidden' value='"+h+"'/><input name='employeeOutList["+employeeOutSeq+"].address' type='hidden' value='"+d+"'/><input name='employeeOutList["+employeeOutSeq+"].birthday' type='hidden' value='"+j+"'/>";$("#form_addEmployeeOutInfo").append(t);employeeOutSeq=employeeOutSeq+1}}}initEmployeeTypeDic_add()}})}}}}function deleteAddInfo(c){var b=$(c).parents("tr").children("td").eq(3).text();console.log(idCardArrays);for(var a=0;a<idCardArrays.length;a++){if(idCardArrays[a]==b){idCardArrays.splice(a,1)}}console.log("sahnchuhou",idCardArrays);$(c).parents("tr").remove()}function initAddModel(){$("#personName").val("");$("#gender").val("");$("#birthday").val("");$("#certNumber").val("");$("#address").val("");$("#add_employeeOutType option:selected").removeAttr("selected");$("#id_img_pers").prop("src",basePathUrl+"/image/userImage.png");$("#idCardImageStr").val("")}function saveEmployeeAndHaulInfo(){var k=$("#add_departmentId").val();var j=$("#add_bigId").val();var d=$("#addEmployeeOutInfoList").children("tr");if(d.length>0){for(var e=0;e<d.length;e++){var a=d.eq(e).children("td");var g=a.eq(0).text();var b=a.eq(3).text();var h=a.eq(4).text();var f=a.eq(5).text();var c="<input name='haulEmployeeOutList["+e+"].unitid' type='hidden' value='"+k+"'/><input name='haulEmployeeOutList["+e+"].bigid' type='hidden' value='"+j+"'/><input name='haulEmployeeOutList["+e+"].empoutidcard' type='hidden' value='"+b+"'/><input name='haulEmployeeOutList["+e+"].emptype' type='hidden' value='"+g+"'/>";+"<input name='haulEmployeeOutList["+e+"].empphysicalstatus' type='hidden' value='"+g+"'/>";+"<input name='haulEmployeeOutList["+e+"].empeducate' type='hidden' value='"+g+"'/>";$("#form_addEmployeeOutInfo").append(c)}$.ajax({url:"employeeOutPerson_addEmployeeOutBatch.action",data:$("#form_addEmployeeOutInfo").serialize(),dataType:"json",type:"post",success:function(i){alert(i.result);$("#el_addEmp").modal("hide");queryEmployeeOutBaseInfo()}})}else{alert("请将要添加的员工信息添加到表格中！")}}function initEmployeeTypeDic_update(a){$.post(basePathUrl+"/dic_getDicNamesByUpid.action",{upId:"100"},function(b){if(b!=null&&b.names!=null){var d=b.names;$("#update_employeeOutType").empty();for(var c=0;c<d.length;c++){if(d[c]==a){$("#update_employeeOutType").append('<option value="'+d[c]+'" selected>'+d[c]+"</option>")}else{$("#update_employeeOutType").append('<option value="'+d[c]+'">'+d[c]+"</option>")}}}},"json")}function el_modifyEmp(e){var a=$(e).parents("tr").children("td");$("#update_employeeOutName").val(a.eq(2).text());$("#update_employeeOutIdCard").val($(e).parents("tr").find(".find_idCard").val());$("#update_departmentName").val(a.eq(5).text());$("#update_employeeOutSex").val(a.eq(3).text());var f=a.eq(3).text();if(f=="男"){$("#update_employeeOutSex1").prop("checked",true)}else{$("#update_employeeOutSex2").prop("checked",true)}var b=$(e).parents("tr").find(".find_employeeOutBirthday").val();var d=$(e).parents("tr").find(".find_employeeOutEducate").val();var c=$(e).parents("tr").find(".find_employeeOutPhy").val();$("#update_employeeEducate").val(d);$("#update_employeePhy").val(c);var i=$(e).parents("tr").find(".find_employeeOutPhoto").val();var h=$(e).parents("tr").find(".find_bigId").val();$("#update_employeeOutBirthday").val(Format(new Date(b.replace(/T/g," ").replace(/-/g,"/")),"yyyy-MM-dd"));$("#update_employeeOutPhoto").prop("src",i);$("#update_employeeOutType").val(a.eq(6).text());initEmployeeTypeDic_update(a.eq(6).text());$("#updateAndDelete_employeeOutIdCard").val($(e).parents("tr").find(".find_idCard").val());$("#updateAndDelete_bigId").val(h);var g=$(e).parents("tr").find(".find_bigEmployeeOutId").val();$("#updateAndDelete_bigemployeeOutId").val(g);$("#el_modifyEmp").modal()}function updateEmployeeOutInfo(){var b=$("#update_employeeOutType option:selected").text();$("#updateAndDelete_employeeType").val(b);var a=$("#update_employeePhy option:selected").text();$("#updateAndDelete_employeeOutPhy").val(a);var c=$("#update_employeeEducate option:selected").text();$("#updateAndDelete_employeeOutEducate").val(c);$.ajax({url:"employeeOutPerson_updateHaulEmployeeOutInfo.action",data:$("#form_updateAndDelete").serialize(),type:"post",dataType:"json",success:function(d){alert(d.result);findEmployeeOutBaseInfo();$("#el_modifyEmp").modal("hide")}})}function el_empTrainDoc(){if($(".el_checks:checked").length=="0"){alert("请选择要查看的员工！")}else{$("#train_empBaseInfo").show();$("#train_empPhoto").show();var c=$(".el_checks:checked").parents("tr").children("td");$("#trainName").text(c.eq(2).text());$("#trainSex").text(c.eq(3).text());$("#trainBlackInfo").text(c.eq(8).text());$("#trainUnit").text(c.eq(5).text());var b=$(".el_checks:checked").parents("tr").find(".find_employeeOutPhoto").val();$("#myimg2").prop("src",b);var a=$(".el_checks:checked").parents("tr").find(".find_idCard").val();showEmployeeOutExamsInfoList(a,1,8)}}function showEmployeeOutExamsInfoList(b,c,a){$.ajax({url:"employeeOutPerson_getExamsInfoByEmployeeOutIdCardLimit.action",data:{employeeOutIdCard:b,currentPage:c,currentCount:a},dataType:"json",type:"post",success:function(j){var e=j.pageBean.productList;var k="";$("#employeeOutExamInfos").empty();for(var g=0;g<e.length;g++){var f=g+1;k="<tr><td>"+(f+(j.pageBean.currentPage-1)*5)+"</td><td>"+e[g].bigName+"</td><td>"+e[g].employeeOutType+"</td><td>"+e[g].examName+"</td><td>"+e[g].level.toString().replace("1","厂级").replace("2","部门级").replace("3","班组级")+"</td><td>"+Format(new Date(e[g].startTime.replace(/T/g," ").replace(/-/g,"/")),"yyyy-MM-dd HH:mm")+"到"+Format(new Date(e[g].endTime.replace(/T/g," ").replace(/-/g,"/")),"yyyy-MM-dd HH:mm")+"</td><td>"+e[g].paperScore+"</td><td>"+e[g].grade+"</td><td>"+e[g].isPass+"</td><td>"+e[g].xueshi+"</td><td>"+e[g].traincontent+"</td></tr>";$("#employeeOutExamInfos").append(k)}var h=j.pageBean.currentPage;var d=j.pageBean.totalCount;trainStatus_page(h,d,b);$("#el_empTrainDoc").modal()}})}function showEmployeeOutExamsInfoAllList(a){$.ajax({url:"employeeOutPerson_getExamsInfoByEmployeeOutIdCard.action",data:{employeeOutIdCard:a},dataType:"json",type:"post",success:function(d){var b=d.examInfos;var e="";$("#employeeOutExamInfos").empty();for(var c=0;c<b.length;c++){e="<tr><td>"+b[c].bigName+"</td><td>"+b[c].employeeOutType+"</td><td>"+b[c].examName+"</td><td>"+b[c].level.toString().replace("1","厂级").replace("2","部门级").replace("3","班组级")+"</td><td>"+Format(new Date(b[c].startTime.replace(/T/g," ").replace(/-/g,"/")),"yyyy-MM-dd HH:mm")+"到"+Format(new Date(b[c].endTime.replace(/T/g," ").replace(/-/g,"/")),"yyyy-MM-dd HH:mm")+"</td><td>"+b[c].paperScore+"</td><td>"+b[c].grade+"</td><td>"+b[c].isPass+"</td></tr>";$("#employeeOutExamInfos").append(e)}$("#el_empTrainDoc").modal()}})}function delcfm(d){var c=$(d).parents("tr").children("td");$("#updateAndDelete_employeeOutIdCard").val($(d).parents("tr").find(".find_idCard").val());var b=$(d).parents("tr").find(".find_bigId").val();$("#updateAndDelete_bigId").val(b);var a=$(d).parents("tr").find(".find_bigEmployeeOutId").val();$("#updateAndDelete_bigemployeeOutId").val(a);$("#delcfmModel").modal()}function urlSubmit(){$.ajax({url:"employeeOutPerson_deleteHaulEmployeeOutInfo.action",data:$("#form_updateAndDelete").serialize(),dataType:"json",type:"post",success:function(a){alert(a.result);findEmployeeOutBaseInfo();$("#delcfmModel").modal("hide")},error:function(){alert("请求失败！")}})}function allInfo(e){var a=$(e).parents("tr").children("td");$("#details_employeeOutName").text(a.eq(2).text());$("#details_employeeOutSex").text(a.eq(3).text());$("#details_employeeOutIdCard").text($(e).parents("tr").find(".find_idCard").val());$("#details_employeeOutIsBlack").text(a.eq(8).text());$("#details_departmentName").text(a.eq(5).text());$("#details_employeeType").text(a.eq(6).text());var b=$(e).parents("tr").find(".find_employeeOutBirthday").val();var d=$(e).parents("tr").find(".find_employeeOutEducate").val();var c=$(e).parents("tr").find(".find_employeeOutPhy").val();var f=$(e).parents("tr").find(".find_thirdScore").val();var g=$(e).parents("tr").find(".find_safeHatNum").val();var i=$(e).parents("tr").find(".find_employeeOutPhoto").val();var h=$(e).parents("tr").find(".find_address").val();$("#details_employeeOutBirthday").text(Format(new Date(b.replace(/T/g," ").replace(/-/g,"/")),"yyyy-MM-dd"));$("#details_employeeOutPhoto").prop("src",i);$("#details_address").text(h);$("#details_employeeEducate").text(replaceNull(d));$("#details_employeePhy").text(replaceNull(c));$("#details_thirdScore").text(replaceNull(f));$("#details_safeHatNum").text(replaceNull(g));$("#allInfo").modal()}function el_breakRulesCase(b){var a=$(b).parents("tr").children("td");var c=a.eq(1).children("input");$("#q_starttime").val($(".query_dep_starttime").val());$("#q_endtime").val($(".query_dep_endtime").val());$("#detailName").val(a.eq(2).text());$("#detailSex").val(a.eq(3).text());$("#detailIdCard").val(c.eq(7).val());$("#detailUnitName").val(a.eq(5).text());$("#detailEmployeeId").val(c.eq(2).val());$("#detailBigEmployeeoutId").val(c.eq(3).val());$("#detail_breakInfoType").val($("#el_breakType").val());$("#detailForm").submit()}$(function(){});function searchDepartmentAndOverHualTree(a){$.ajax({type:"post",target:"#departmentAndOverHaulTree",data:{markTrainType:"1",bigStatusMark:a},dataType:"json",url:"employeeOutPerson_getDepartmentAndOverHaulTree.action",success:getTree_1,error:function(){alert("请求树失败！")}})}function getTree_1(b){var a=b.departmentAndOverHaulTree;var e={data:{simpleData:{enable:true,idKey:"id",pIdKey:"upid",rootPId:null,},key:{name:"name",}},callback:{onClick:onClick}};var g=a;var d,c="dark";$.fn.zTree.init($("#departmentAndOverHaulTree"),e,g);var f=$.fn.zTree.getZTreeObj("departmentAndOverHaulTree");f.expandAll(false)}var clickRes=0;var clickBigAndDepTree=0;var selectedDepartmentName;var selectedDepartmentID;var selectedOverHaulId;function onClick(a,c,b){$("#currentPage").val("");clickBigAndDepTree=1;selectedOverHaulId=b.id;selectedDepartmentID=b.upid;$("#query_bigId").val(selectedOverHaulId);$("#query_unitId").val(selectedDepartmentID);if(selectedDepartmentID==null){queryEmployeeOutBaseInfo()}if(b.level==1){clickRes=1;$("#add_departmentName").val(b.name);$("#add_departmentId").val(b.id);$("#add_bigId").val(b.upid);selectedDepartmentID=b.id;selectedOverHaulId=b.upid;$("#query_bigId").val(selectedOverHaulId);$("#query_unitId").val(selectedDepartmentID);queryEmployeeOutBaseInfo()}else{clickRes=0}return(b.click!=false)}function el_addBreakInfo(){var k=0;$.each($(".el_checks"),function(m,n){if($(this).prop("checked")){k++}});if(k!=1){alert("请选中员工之后再添加违章信息！");return false}else{var b=$(".el_checks:checked").parents("tr").children("td");var l=b.eq(2).text();var h=b.eq(3).text();var f=b.eq(7).text();var c=b.eq(5).text();var d=b.eq(8).text();$("#addName").text(l);$("#addSex").text(h);$("#addbreakScore").text(f);$("#addunitName").text(c);$("#addIsBreak").text(d);var i=b.eq(1).children("input");var g=i.eq(2).val();var j=i.eq(3).val();var e=i.eq(5).val();var a=i.eq(6).val();$("#addEmployee").val(g);$("#addBigHaulEmployeeId").val(j);$("#addUnitidM").val(e);$("#breakScoreID").val("");$("#addBreakContent").val("");$("#beforeBreakScore").val(a);if($("#addIsBreak").text()=="是"){alert("处于黑名单的外来职工不能添加违章积分")}else{$("#el_addBreakInfo").modal()}}}function addSaveBtn(){var b=$("#beforeBreakScore").val();var a=$("#breakScoreID").val();if(a>=12){$("#addAlertMsg").modal()}else{if(parseInt(b)+parseInt(a)>=12){alert("该员工的违章记分累计超过12分")}addSaveBtnAfter()}}function addAlertMsgBtn(){addSaveBtnAfter()}function addSaveBtnAfter(){var a=$("#addForm").validate({ignore:[],rules:{"breakrules.breaktime":"required","breakrules.minusnum":{required:true,isNumber:true},"breakrules.breakcontent":"required"},messages:{"breakrules.breaktime":{required:"不能为空"},"breakrules.minusnum":{required:"不能为空",isNumber:"请输入一个数字"},"breakrules.breakcontent":{required:"不能为空"}}});if(a.form()){$.ajax({url:contextPath+"/breakrules_addBreakrule.action",data:$("#addForm").serialize(),dataType:"json",type:"POST",async:true,success:function(b){alert(b.result);queryEmployeeOutBaseInfo()},error:function(){alert("添加失败，请从新添加")}});$("#el_addBreakInfo").modal("hide")}}function historyBreakInfoFind2(){var a=$("#el_breakType").val();$("#breakInfo_Type").val(a);findEmployeeOutBaseInfo()}function queryEmployeeOutTrainInfo(){$("#train_empBaseInfo").hide();$("#train_empPhoto").hide();var a=$("#certNumber").val();if(a!=null&&a!=""){showEmployeeOutExamsInfoList(a,1,8)}}function historyBigInfoFind(){var a=$("#el_bigStatusMark").val();$("#bigStatus_Mark").val(a);searchDepartmentAndOverHualTree(a);$("#currentPage").val("");findEmployeeOutBaseInfo()}$(function(){showMessage()});function showMessage(){var a=document.getElementById("msg");queryOlderPerson();a.firstElementChild.onclick=function(){a.style.bottom="-300px";setTimeout(function(){queryOlderPerson()},60*60*1000)}}function queryOlderPerson(){$.post(contextPath+"/message_getUnreadMessageByEmpType.action",{empType:"0"},showOlderTable,"json")}function showOlderTable(a){$("#olderTable").html("");var e=document.getElementById("msg");var c=a.messages;if(c==null){e.style.bottom="-300px";return}for(var b=0,d=c.length;b<d;b++){$("#olderTable").append("<tr><td>"+c[b].name+'<input type="hidden" class="messageid" value="'+c[b].messageid+'"></td><td>'+c[b].idcode+"</td><td>"+c[b].birthday+'</td><td><a class="button" href=javascript:void(0) onclick="readMessage(this)">删除消息</a></td></tr>')}if($("#olderTable").find("tr").length>0){e.style.bottom="0"}}function readMessage(b){var a=$(b).parents("tr").children(":first").find(".messageid").val();$.post(contextPath+"/message_updateMessageByMessageId.action",{messageid:a},function(c){if(c.result=="读取成功"){alert("已经成功处理！");queryOlderPerson()}},"json")}function toggleQueryDiv(){if($("#queryDiv").css("display")=="none"){$("#queryDiv").show("slow",function(){$(".glyphicon-chevron-down").removeClass().addClass("glyphicon glyphicon-chevron-up").prop("title","点击隐藏查询条件")})}else{$("#queryDiv").hide("slow",function(){$(".glyphicon-chevron-up").removeClass().addClass("glyphicon glyphicon-chevron-down").prop("title","点击显示查询条件")})}}var initEmployeePhyAndEducate=function(){$.post(contextPath+"/settingAction_getSettingsJSON.do",function(a){if(a){if(a.educateBackground){for(var b=0,d=a.educateBackground.length;b<d;b++){var c=a.educateBackground[b];$(".employeeEducate").append("<option value='"+c+"'>"+c+"</>")}}if(a.physicalStatus){for(var b=0,d=a.physicalStatus.length;b<d;b++){var c=a.physicalStatus[b];$(".employeePhy").append("<option value='"+c+"'>"+c+"</>")}}}},"json")};function replaceNull(b,a){if(b==null||b==undefined||b==""||b=="undefined"){return""}if(a==null||a==""){return b}return b.toString().substr(0,a)}function queryHatChangeLog(a){if(a){$("#safeHatChangeDetail").html("");$.post(basePathUrl+"/safeHat_getSafehatChangelog.do",{originSafeHatNum:$(a).text()},function(c){if(c){for(var b=0,e=c.data.length;b<e;b++){var d="<tr><td>"+(b+1)+"</td><td>"+c.data[b]+"</td></tr>";$("#safeHatChangeDetail").append(d)}$("#SafeHatModal").modal({backdrop:"static",keyboard:false})}},"json")}};